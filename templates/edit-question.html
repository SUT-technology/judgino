<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ูพุฑููุงู</title>
    <link rel="stylesheet" href="/static/css/lib/daisyui.min.css">
    <script src="/static/js/lib/tailwind.min.js"></script>
    <script src="/static/js/config.js"></script>
    <link rel='stylesheet' href='/static/css/lib/uicons-regular-rounded.css'>
    <link rel='stylesheet' href='/static/css/lib/uicons-solid-rounded.css'>
    <link rel="stylesheet" href="/static/css/style.css">
</head>

<body>
    <header>
        <button class="pr-4 pt-5 lg:hidden" onclick="handlemenu()"><i
                    class="fi fi-sr-bars-staggered text-2xl"></i></button>
        <div id="backdrop-menu" onclick="handlemenu()"
             class="fixed top-0 right-0 bg-black bg-opacity-50 w-screen h-screen lg:hidden hidden z-10"></div>
        <nav class="bg-gray-20 bg-opacity-45 backdrop-blur-3xl p-3 lg:w-2/12 w-1/2 h-[90vh] fixed lg:right-0 right-[-100%] top-[5%] rounded-l-2xl shadow-lg transition-all duration-300 z-20"
             id="menu">
            <div class="text-center font-fedra text-2xl mt-5">
                judgino
            </div>
            <ul class="menu rounded-box mt-20">
                <li class="mb-3">
                    <a href="/questions">
                        <i class="fi fi-rr-home"></i>
                        ุณูุงู ูุง
                    </a>
                </li>
                <li class="mb-3 bg-gray-38 rounded-lg">
                    <a>
                        <i class="fi fi-rr-edit"></i>
                        ุณูุงู ุฌุฏุฏ
                    </a>
                </li>
                <li class="mb-3">
                    <a href="/questions/submissions">
                        <i class="fi fi-rr-checkbox"></i>
                        ุงุฑุณุงู ูุง
                    </a>
                </li>
                </li>
                <li class="mb-3">
                    <a href="/profile/{{.UserID}}">
                        <i class="fi fi-rr-user"></i>
                        ูพุฑููุงู
                    </a>
                </li>
                <!-- <li class="mb-3">
                    <a>
                        <i class="fi fi-rr-user-pen"></i>
                        ูุฑุงุด ูพุฑููุงู
                    </a>
                </li> -->
            </ul>
        </nav>
    </header>
    
    <div class="lg:w-10/12 p-3 mr-auto mt-6">
        <section class="bg-gray-20 bg-opacity-45 min-h-full backdrop-blur-3xl p-3 rounded-2xl w-full min-h-[90h] z-20">
            <div class="card lg:w-8/12 w-10/12  mx-auto bg-gray-700 bg-opacity-30 backdrop-blur-xl p-4 rounded-xl">
                <div class="inp-con">
                    <input type="text" id="title"data-validations="required" class="text-input h-12 text-lg px-4 bg-gray-800 rounded-lg border border-gray-700" placeholder={{.Title}} py-3/>
                    <i class="fi fi-sr-check-circle -text-success hidden error-icon"></i>
                    <i class="fi fi-sr-exclamation -text-error hidden success-icon"></i>
                </div>
                <br>
                <div 
                    id="textEditor"
                    contenteditable="true"
                    spellcheck="false"
                    class="mt-6 w-full min-h-[200px] p-4 bg-gray-800 rounded-lg border border-gray-700 whitespace-pre-wrap overflow-y-auto focus:outline-none"
                >{{.Body}}</div>
                <br>
                <br>
                <div class="flex w-full">
                <div
                    class="inp-con">
                    
                    <input type="text" id="timeLimit" data-validations="required" class="text-input h-12 text-lg px-4 bg-gray-800 rounded-lg border border-gray-700" placeholder={{.TimeLimit}} py-3/>
                    
                    <i class="fi fi-sr-check-circle -text-success hidden error-icon"></i>
                    <i class="fi fi-sr-exclamation -text-error hidden success-icon"></i>
                </div>
                <div class="divider divider-horizontal"></div>
                <div
                    class="inp-con">
                    
                    <input type="text" id="memoryLimit" data-validations="required" class="text-input h-12 text-lg px-4 bg-gray-800 rounded-lg border border-gray-700" placeholder={{.MemoryLimit}} py-3/>
                    
                    <i class="fi fi-sr-check-circle -text-success hidden error-icon"></i>
                    <i class="fi fi-sr-exclamation -text-error hidden success-icon"></i>
                </div>
            </div>
                <br>
                <br>
                <div class="flex w-full">
                    <div class="inp-con">
                    <input type="text" id="input" data-validations="required" class="text-input h-12 text-lg px-4 bg-gray-800 rounded-lg border border-gray-700" placeholder={{.InputURL}} py-3/>
                    <i class="fi fi-sr-check-circle -text-success hidden error-icon"></i>
                    <i class="fi fi-sr-exclamation -text-error hidden success-icon"></i>
                </div>
                    <div class="divider divider-horizontal"></div>
                    <div
                    class="inp-con">
                    <input type="text" id="output" data-validations="required" class="text-input h-12 text-lg px-4 bg-gray-800 rounded-lg border border-gray-700" placeholder={{.OutputURL}} py-3/>
                    <i class="fi fi-sr-check-circle -text-success hidden error-icon"></i>
                    <i class="fi fi-sr-exclamation -text-error hidden success-icon"></i>
                </div>
                
            </div>
            <br>
            <br>  
            <div class="bg-gray-800 m-4 p-4 rounded-lg space-y-4">
                    <label for="daysSlider" class="block mb-2 text-lg">๐ ุฑูุฒ: <span id="daysValue">1</span></label>
                    <input id="daysSlider" type="range" min="1" max="365" value={{.DeadlineDay}}
                      class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-blue-500">
                  </div>
                  <div class="bg-gray-800 m-4 p-4 rounded-lg space-y-4">
                    <label for="hoursSlider" class="block mb-2 text-lg">๐ ุณุงุนุช: <span id="hoursValue">0</span></label>
                    <input id="hoursSlider" type="range" min="0" max="23" value={{.DeadlineHour}}
                      class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-blue-500">
                  </div>
                  <div class="bg-gray-800 m-4 p-4 rounded-lg space-y-4">
                    <label for="minutesSlider" class="block mb-2 text-lg">โฑ๏ธ ุฏููู: <span id="minutesValue">0</span></label>
                    <input id="minutesSlider" type="range" min="0" max="59" value={{.DeadlineMinute}}
                      class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-blue-500">
                  </div>
                  <div>
                    <button 
      class="mt-6 px-6 py-2 bg-gray-800 hover:bg-gray-900 text-white text-lg rounded-lg transition duration-200" id="button">
      ุทุฑุญ ุณูุงู
    </button>
                </div>
                </div>
        
        </section>
    </div>
    <script>
        document.getElementById("button").addEventListener('click', async () => {
            const title = document.getElementById('title').value;
            const body = document.getElementById('textEditor').innerText.trim();
            const timeLimit = parseInt(document.getElementById('timeLimit').value);
            const memoryLimit = parseInt(document.getElementById('memoryLimit').value);
            const inputURL = document.getElementById('input').value;
            const outputURL = document.getElementById('output').value;
        
            const days = parseInt(document.getElementById('daysSlider').value);
            const hours = parseInt(document.getElementById('hoursSlider').value);
            const minutes = parseInt(document.getElementById('minutesSlider').value);
        
            // Construct deadline from now + sliders
            const now = new Date();
            const deadline = new Date(now);
            deadline.setDate(now.getDate() + days);
            deadline.setHours(now.getHours() + hours);
            deadline.setMinutes(now.getMinutes() + minutes);
        
            const data = {
                UserID: 1, // replace with actual user ID
                Status: "{{.Status}}", // or "published", etc.
                Title: title,
                Body: body,
                TimeLimit: timeLimit,
                MemoryLimit: memoryLimit,
                InputURL: inputURL,
                Deadline: deadline.toISOString(),
                OutputURL: outputURL
            };

            console.log(data)
            try {
                fetch("/questions/update/{{.QuestionID}}", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify(data)
                }).then(response => {
                    if (response.ok) {
                        alert("ุณูุงู ูุฑุงุด ุดุฏ");
                    } else {
                        alert("ุฎุทุง ุฏุฑ ูุฑุงุด ุณูุงู")
                    }
            })  
            } catch (error) {
                console.error("Network error:", error);
                alert("ุฎุทุง ุดุจฺฉู!");
            }
        });
        </script>
        
    <script src="/static/js/slider.js"></script>
    <script src="/static/js/forms.js"></script>
    <script src="/static/js/main.js"></script>
    </body>
    </html>